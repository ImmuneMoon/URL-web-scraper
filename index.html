<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width">
        <meta name="description" content="URL scraper for AI Time internship program">
        <meta name="author" content="Alex Page">
        <link rel="icon" href="./Images/dev_window.ico" />
        <title>URL Scraper by Alex Page</title>
        <link rel="stylesheet" href="./styles.css">
    </head>
    <body>
        <main>
            <section id="form">
                <form>
                    <h1>
                        Web Page URL Scraper
                    </h1>
                    <div id="input_container">
                        <label for="url">
                            URL:
                        </label>
                        <input 
                        required
                        type="text" 
                        id="url"  
                        minlength=1 
                        maxlength=50 
                        placeholder="Insert webpage link here"
                        >
                    </div>
                    <button onclick="scrape();" >Scrape</button>
                </form>
            </section>
        </main>
        <script>
            const axios = require("axios");
            const cheerio = require("cheerio");
            function scrape() {
                let site = document.querySelectorAll('#url').values();
                console.log('site: ', site);
                
                request(site, (error, response, html) => {
                    if (!error && response.statusCode == 200) {
                        console.log(html);
                    }

                    else {
                        return fetch;
                    }
                });

                function fetch() {
                    let site = document.querySelectorAll('#url').values();
                    const fetchTitles = async () => {
                        try {
                            const response = await        
                            
                            axios.get(site);
                        
                            const html = response.data;
                        
                            const $ = cheerio.load(html);
                        
                            const links = [];
                        
                            $('a.href').each((_idx, el) => {
                                const url = $(el).text()
                                links.push(url)
                            });
                        
                            return links;
                        } 
                        catch (error) {
                            throw error;
                        }};
                    
                    fetchTitles().then((links) => console.log(links));
                }

                return request();
            }
        </script>
    </body>
</html>